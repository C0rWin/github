
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Java Collections, Guava, reducing boilerplate code - Short notes</title>
  <meta name="author" content="C0rWin">

  
  <meta name="description" content="">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://pensieve.info/blog/2013/10/16/java-collections">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/bootstrap/bootstrap.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/bootstrap/responsive.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/syntax/syntax.css" media="screen, projection" rel="stylesheet" type="text/css">
  <style type="text/css">
    body {
      padding-bottom: 40px;
    }
    h1 {
      margin-bottom: 15px;
    }
    img {
      max-width: 100%;
    }
    .sharing, .meta, .pager {
      margin: 20px 0px 20px 0px;
    }
    .page-footer p {
      text-align: center;
    }
  </style>
  <script src="/javascripts/libs/jquery.js"></script>
  <script src="/javascripts/libs/modernizr-2.0.js"></script>
  <script src="/javascripts/libs/bootstrap.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Short notes" type="application/atom+xml">
  <!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  jax: ["input/TeX", "output/HTML-CSS"],
  tex2jax: {
    inlineMath: [ ['$', '$'] ],
    displayMath: [ ['$$', '$$']],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  messageStyle: "none",
  "HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] }
});
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
  

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44230239-1', 'pensieve.info');
  ga('send', 'pageview');

</script>



</head>

<body   >
  <nav role="navigation"><div class="navbar navbar-inverse">
  <div class="navbar-inner">
    <div class="container">
      <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </a>

      <a class="brand" href="/">Short notes</a>

      <div class="nav-collapse">
        <ul class="nav">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>


        <ul class="nav pull-right" data-subscription="rss">
          <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
          
        </ul>

        
          <form class="pull-right navbar-search" action="http://google.com/search" method="get">
            <fieldset role="search">
              <input type="hidden" name="q" value="site:pensieve.info" />
              <input class="search-query" type="text" name="q" results="0" placeholder="Search"/>
            </fieldset>
          </form>
        
      </div>
    </div>
  </div>
</div>
</nav>
  <div class="container">
    <div class="row-fluid">
      
<article class="hentry span9" role="article">

  
  <header class="page-header">
    
      <h1 class="entry-title">Java Collections, Guava, Reducing Boilerplate Code</h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-10-16T15:11:00+03:00" pubdate data-updated="true">Oct 16<span>th</span>, 2013</time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>Guava is a framework developed by Google to bridge the gap in Java SDK Collections API&rsquo;s. It introduces quite a lot of different techniques and development patterns which one was expecting to find in regular Collections API, but apparently wasn&rsquo;t able. I will try to show a few different techniques which helps me to reduce boilerplate code in my projects.</p>

<!-- more -->


<h3>1. Getting element at position i from Set.</h3>

<p>How often you&rsquo;ve seen something similar to following code?</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">Set</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">names</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashSet</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;(</span> <span class="o">);</span>
</span><span class='line'><span class="n">names</span><span class="o">.</span><span class="na">add</span><span class="o">(</span> <span class="s">&quot;John D.&quot;</span><span class="o">);</span>
</span><span class='line'><span class="c1">// ...</span>
</span><span class='line'><span class="c1">// and then you realize you need to pull first item from your collection</span>
</span><span class='line'><span class="n">Iterator</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">it</span> <span class="o">=</span> <span class="n">names</span><span class="o">.</span><span class="na">iterator</span><span class="o">(</span> <span class="o">);</span>
</span><span class='line'><span class="n">String</span> <span class="n">firstName</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="na">next</span><span class="o">(</span> <span class="o">);</span>
</span></code></pre></td></tr></table></div></figure>


<p> Or it might be even worse:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'> <span class="n">Set</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">names</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashSet</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;(</span> <span class="o">);</span>
</span><span class='line'> <span class="n">names</span><span class="o">.</span><span class="na">add</span><span class="o">(</span> <span class="s">&quot;John D.&quot;</span><span class="o">);</span>
</span><span class='line'> <span class="c1">// adding more names skipped.</span>
</span><span class='line'> <span class="c1">// and now we need 5th element from the set.</span>
</span><span class='line'> <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">it</span> <span class="o">=</span> <span class="n">names</span><span class="o">.</span><span class="na">iterator</span><span class="o">(</span> <span class="o">);</span>
</span><span class='line'>
</span><span class='line'> <span class="k">for</span><span class="o">(</span> <span class="kt">int</span> <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">it</span><span class="o">.</span><span class="na">hasNext</span><span class="o">(</span> <span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="n">idx</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="o">;</span> <span class="n">idx</span><span class="o">++,</span><span class="n">it</span><span class="o">.</span><span class="na">next</span><span class="o">(</span> <span class="o">)</span> <span class="o">)</span> <span class="o">{</span>
</span><span class='line'>      <span class="c1">// Iterate over</span>
</span><span class='line'>
</span><span class='line'> <span class="n">String</span> <span class="n">fithElement</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
</span><span class='line'> <span class="k">if</span> <span class="o">(</span> <span class="n">it</span><span class="o">.</span><span class="na">hasNext</span><span class="o">(</span> <span class="o">))</span> <span class="o">{</span> <span class="c1">// We stoped because idx reached 4, hence skipped only 4 items.</span>
</span><span class='line'>  <span class="n">fithElement</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="na">hext</span><span class="o">(</span> <span class="o">);</span>
</span><span class='line'> <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span><span class='line'>  <span class="n">fithElement</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
</span><span class='line'> <span class="o">}</span>
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>


<p> To avoid writing again and again these lines of code Guava, introduces FluentIterable interface and util class Iterables which enables us to re-write lines from above as follows:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'> <span class="c1">// Same initialization as previous</span>
</span><span class='line'> <span class="n">String</span> <span class="n">firstElement</span> <span class="o">=</span> <span class="n">Iterables</span><span class="o">.</span><span class="na">get</span><span class="o">(</span> <span class="n">names</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span>
</span><span class='line'> <span class="c1">// And</span>
</span><span class='line'> <span class="n">String</span> <span class="n">fithElement</span> <span class="o">=</span> <span class="n">Iterables</span><span class="o">.</span><span class="na">get</span><span class="o">(</span> <span class="n">names</span><span class="o">,</span> <span class="mi">4</span><span class="o">);</span>
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>


<p> Or with edge cases of first or last element it might looks like:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'> <span class="n">String</span> <span class="n">firstElement</span> <span class="o">=</span> <span class="n">Iterables</span><span class="o">.</span><span class="na">getFirst</span><span class="o">(</span> <span class="n">names</span><span class="o">,</span> <span class="s">&quot;defaultValue&quot;</span><span class="o">);</span> <span class="c1">// return first element from set of names</span>
</span><span class='line'> <span class="n">String</span> <span class="n">lastElement</span> <span class="o">=</span> <span class="n">Iterables</span><span class="o">.</span><span class="na">getLast</span><span class="o">(</span> <span class="n">names</span><span class="o">);</span> <span class="c1">// return the last element</span>
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>


<h3>2. Finding element in collection of complex POJO.</h3>

<p>For now suppose we have a famous Person pojo, which looks like:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">class</span> <span class="nc">Person</span> <span class="o">{</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">private</span> <span class="n">String</span> <span class="n">firstName</span><span class="o">;</span>
</span><span class='line'>  
</span><span class='line'>  <span class="kd">private</span> <span class="n">String</span> <span class="n">lastName</span><span class="o">;</span>
</span><span class='line'>  
</span><span class='line'>  <span class="kd">private</span> <span class="n">String</span> <span class="n">email</span><span class="o">;</span>
</span><span class='line'>  
</span><span class='line'>  <span class="kd">public</span> <span class="nf">Person</span><span class="o">(</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">firstName</span><span class="o">,</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">lastName</span><span class="o">,</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">email</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">this</span><span class="o">.</span><span class="na">firstName</span> <span class="o">=</span> <span class="n">firstName</span><span class="o">;</span>
</span><span class='line'>      <span class="k">this</span><span class="o">.</span><span class="na">lastName</span> <span class="o">=</span> <span class="n">lastName</span><span class="o">;</span>
</span><span class='line'>      <span class="k">this</span><span class="o">.</span><span class="na">email</span> <span class="o">=</span> <span class="n">email</span><span class="o">;</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>  
</span><span class='line'>  <span class="kd">public</span> <span class="n">String</span> <span class="nf">getFirstName</span> <span class="o">(</span> <span class="o">)</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="n">firstName</span><span class="o">;</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>  
</span><span class='line'>  <span class="kd">public</span> <span class="n">String</span> <span class="nf">getLastName</span><span class="o">(</span> <span class="o">)</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="n">lastName</span><span class="o">;</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>  
</span><span class='line'>  <span class="kd">public</span> <span class="n">String</span> <span class="nf">getEmail</span><span class="o">(</span> <span class="o">)</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="n">email</span><span class="o">;</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>  
</span><span class='line'>  <span class="c1">// omitting setters since not relevant for current demo/example.</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now we have a collection of persons say:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">List</span><span class="o">&lt;</span><span class="n">Person</span><span class="o">&gt;</span> <span class="n">people</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Person</span><span class="o">&gt;(</span> <span class="o">);</span>
</span><span class='line'>
</span><span class='line'><span class="n">people</span><span class="o">.</span><span class="na">add</span><span class="o">(</span> <span class="k">new</span> <span class="n">Person</span><span class="o">(</span> <span class="s">&quot;John&quot;</span><span class="o">,</span> <span class="s">&quot;Doe&quot;</span><span class="o">,</span> <span class="s">&quot;john@doe.com&quot;</span><span class="o">));</span>
</span><span class='line'><span class="n">people</span><span class="o">.</span><span class="na">add</span><span class="o">(</span> <span class="k">new</span> <span class="n">Person</span><span class="o">(</span> <span class="s">&quot;William&quot;</span><span class="o">,</span> <span class="s">&quot;McLoren&quot;</span><span class="o">,</span> <span class="s">&quot;william@mcloren.com&quot;</span><span class="o">));</span>
</span><span class='line'><span class="c1">//...</span>
</span><span class='line'><span class="n">people</span><span class="o">.</span><span class="na">add</span><span class="o">(</span>  <span class="k">new</span> <span class="n">Person</span><span class="o">(</span> <span class="s">&quot;Bruce&quot;</span><span class="o">,</span> <span class="s">&quot;Jonson&quot;</span><span class="o">,</span> <span class="s">&quot;bruce@jonson.com&quot;</span><span class="o">));</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now we need to lookup from this collection all persons with name &ldquo;John&rdquo;. With plain Java Collections SDK it might look like:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">Person</span> <span class="n">result</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
</span><span class='line'><span class="k">for</span> <span class="o">(</span> <span class="n">Person</span> <span class="nl">each:</span> <span class="n">people</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>  <span class="k">if</span> <span class="o">(</span> <span class="s">&quot;John&quot;</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span> <span class="n">each</span><span class="o">.</span><span class="na">getFirstName</span><span class="o">(</span> <span class="o">)))</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">result</span> <span class="o">=</span> <span class="n">each</span><span class="o">;</span>
</span><span class='line'>      <span class="k">break</span><span class="o">;</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'><span class="o">}</span>  
</span></code></pre></td></tr></table></div></figure>


<p>Guava Iterables utils class introduce find method which get two parameters an intance of Iterable interface and Predicate, method iterates over all elements and returns back on those which muches the predicate (e.g. predicate return true for them). Now it became:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">class</span> <span class="nc">FirstNamePredicate</span> <span class="kd">implements</span> <span class="n">Predicate</span><span class="o">&lt;</span><span class="n">Person</span><span class="o">&gt;</span> <span class="o">{</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">private</span> <span class="n">String</span> <span class="n">firstName</span><span class="o">;</span>
</span><span class='line'>  
</span><span class='line'>  <span class="kd">public</span> <span class="nf">FirstNamePredicate</span><span class="o">(</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">firstName</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">this</span><span class="o">.</span><span class="na">firstName</span> <span class="o">=</span> <span class="n">firstName</span><span class="o">;</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>      
</span><span class='line'>  <span class="nd">@Overide</span>
</span><span class='line'>  <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">apply</span><span class="o">(</span> <span class="n">Person</span> <span class="n">person</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="n">firstName</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span> <span class="n">person</span><span class="o">.</span><span class="na">getFirstName</span><span class="o">(</span> <span class="o">));</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// and now we can use it to seach element we would like from given collection.</span>
</span><span class='line'>
</span><span class='line'><span class="n">Iterable</span><span class="o">&lt;</span><span class="n">Person</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">Iterables</span><span class="o">.</span><span class="na">find</span><span class="o">(</span> <span class="n">people</span><span class="o">,</span> <span class="k">new</span> <span class="n">FirstNamePredicate</span><span class="o">(</span> <span class="s">&quot;John&quot;</span><span class="o">));</span>
</span></code></pre></td></tr></table></div></figure>


<p>Basically one line will do the work, while previously we have had to use for each loop. Now one could possibly argue and say &ldquo;Wait a moment! Instead of simple for each you have written done a whole class!&rdquo;. And my answer for that yes of course I did! Now I do able to reuse my code, now I then I&rsquo;ve lookup logic decoupled I can easily test it. Moreover this is just one simple example, but as you can imagine it could be much more complicated then this specific one.</p>

<p>Now, we have to pay attention on the fact that find method will result in run-time exception in case element is not found which will lead to following code:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="k">try</span> <span class="o">{</span>
</span><span class='line'>  <span class="n">Iterable</span><span class="o">&lt;</span><span class="n">Person</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">Iterables</span><span class="o">.</span><span class="na">find</span><span class="o">(</span> <span class="n">people</span><span class="o">,</span> <span class="k">new</span> <span class="n">FIrstNamePredicate</span><span class="o">(</span> <span class="s">&quot;John&quot;</span><span class="o">));</span>
</span><span class='line'><span class="k">catch</span> <span class="o">(</span> <span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>  <span class="c1">// And here need to take care of cases where element is not found.</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>A much nicer way will be to use recently introduced new method of <strong>Iterables</strong> which is <strong>tryFind</strong>, as a result it will return instance of <strong>Optional</strong> and in case there is no such element in collection instead of having to handle exceptional case now you can simply :</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">Optional</span><span class="o">&lt;</span><span class="n">Person</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">Iterables</span><span class="o">.</span><span class="na">tryFind</span><span class="o">(</span> <span class="n">people</span><span class="o">,</span> <span class="k">new</span> <span class="n">FIrstNamePredicate</span><span class="o">(</span> <span class="s">&quot;John&quot;</span><span class="o">));</span>
</span><span class='line'><span class="c1">// and now you can check whenever value of object is presented</span>
</span><span class='line'><span class="k">if</span> <span class="o">(</span> <span class="n">result</span><span class="o">.</span><span class="na">isPresent</span><span class="o">(</span> <span class="o">))</span> <span class="o">{</span>
</span><span class='line'>  <span class="n">handleResult</span><span class="o">(</span> <span class="n">result</span><span class="o">.</span><span class="na">get</span><span class="o">(</span> <span class="o">));</span>
</span><span class='line'><span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span><span class='line'>  <span class="n">handleNoResult</span><span class="o">(</span> <span class="n">result</span><span class="o">);</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Or it could be even:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">Optional</span><span class="o">&lt;</span><span class="n">Person</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">Iterables</span><span class="o">.</span><span class="na">tryFind</span><span class="o">(</span> <span class="n">people</span><span class="o">,</span> <span class="k">new</span> <span class="n">FIrstNamePredicate</span><span class="o">(</span> <span class="s">&quot;John&quot;</span><span class="o">)).</span><span class="na">or</span><span class="o">(</span> <span class="k">new</span> <span class="n">Person</span><span class="o">(</span> <span class="s">&quot;UFO&quot;</span><span class="o">,</span><span class="s">&quot;Alien&quot;</span><span class="o">));</span>
</span><span class='line'><span class="c1">// and it will always will return you optional result with some value</span>
</span><span class='line'><span class="c1">// hence no need to check for presence you can simple call get method</span>
</span><span class='line'><span class="c1">// of course you will have to handle default value differently.</span>
</span><span class='line'><span class="n">Person</span> <span class="n">person</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="na">get</span><span class="o">(</span> <span class="o">);</span>
</span><span class='line'><span class="n">handleResult</span><span class="o">(</span> <span class="n">person</span><span class="o">);</span>
</span></code></pre></td></tr></table></div></figure>


<h3>3. Building map and reverse map.</h3>

<p>Sometimes you have to build up some dictionary on your Java code, e.g. you have set of relations between two entity types and could be even between entity and Java primitives. Say you have key of type <strong>A</strong> and value of type <strong>B</strong>. You probably will finish with writing something like:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">Map</span><span class="o">&lt;</span><span class="n">A</span><span class="o">,</span> <span class="n">B</span><span class="o">&gt;</span> <span class="n">dictionary</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">A</span><span class="o">,</span> <span class="n">B</span><span class="o">&gt;(</span> <span class="o">);</span>
</span><span class='line'><span class="c1">// now the initialization loop</span>
</span><span class='line'> <span class="k">while</span> <span class="o">(</span> <span class="n">it</span><span class="o">.</span><span class="na">hasMore</span><span class="o">(</span> <span class="o">))</span> <span class="o">{</span>
</span><span class='line'>  <span class="n">B</span> <span class="n">val</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="na">next</span><span class="o">(</span> <span class="o">);</span>
</span><span class='line'>  <span class="n">A</span> <span class="n">key</span> <span class="o">=</span> <span class="n">computeKey</span><span class="o">(</span> <span class="n">val</span><span class="o">);</span>
</span><span class='line'>  <span class="n">dictionary</span><span class="o">.</span><span class="na">put</span><span class="o">(</span> <span class="n">key</span><span class="o">,</span> <span class="n">val</span><span class="o">);</span>
</span><span class='line'> <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>But now, suppose that relation between <strong>A</strong> and <strong>B</strong> is one to one and you would like to have possibility to make look up for values in both directions, so the code now will look like:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">Map</span><span class="o">&lt;</span><span class="n">A</span><span class="o">,</span> <span class="n">B</span><span class="o">&gt;</span> <span class="n">dictionary</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">A</span><span class="o">,</span> <span class="n">B</span><span class="o">&gt;(</span> <span class="o">);</span>
</span><span class='line'><span class="n">Map</span><span class="o">&lt;</span><span class="n">B</span><span class="o">,</span> <span class="n">A</span><span class="o">&gt;</span> <span class="n">reverseDictionary</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">B</span><span class="o">,</span> <span class="n">A</span><span class="o">&gt;(</span> <span class="o">)</span>
</span><span class='line'><span class="c1">// now the initialization loop</span>
</span><span class='line'> <span class="k">while</span> <span class="o">(</span> <span class="n">it</span><span class="o">.</span><span class="na">hasMore</span><span class="o">(</span> <span class="o">))</span> <span class="o">{</span>
</span><span class='line'>  <span class="n">B</span> <span class="n">val</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="na">next</span><span class="o">(</span> <span class="o">);</span>
</span><span class='line'>  <span class="n">A</span> <span class="n">key</span> <span class="o">=</span> <span class="n">computeKey</span><span class="o">(</span> <span class="n">val</span><span class="o">);</span>
</span><span class='line'>  <span class="n">dictionary</span><span class="o">.</span><span class="na">put</span><span class="o">(</span> <span class="n">key</span><span class="o">,</span> <span class="n">val</span><span class="o">);</span>
</span><span class='line'>  <span class="n">reverseDictionary</span><span class="o">(</span> <span class="n">val</span><span class="o">,</span> <span class="n">key</span><span class="o">);</span>
</span><span class='line'> <span class="o">}</span>
</span><span class='line'>
</span><span class='line'> <span class="c1">// now we able to make lookup in both directions</span>
</span><span class='line'> <span class="c1">// say having key we can get value:</span>
</span><span class='line'> <span class="n">B</span> <span class="n">val</span> <span class="o">=</span> <span class="n">dictionary</span><span class="o">.</span><span class="na">get</span><span class="o">(</span> <span class="n">key</span><span class="o">);</span>
</span><span class='line'>
</span><span class='line'> <span class="c1">// or having value we can get a key</span>
</span><span class='line'> <span class="n">A</span> <span class="n">key</span> <span class="o">=</span> <span class="n">reverseDictionary</span><span class="o">(</span> <span class="n">val</span><span class="o">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>Guava introduce new collection type called <strong>BiMap</strong>, which is bidirectional map, designed to answer the question similar to current example, so instead of having code above we can simply write:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">BiMap</span><span class="o">&lt;</span><span class="n">A</span><span class="o">,</span> <span class="n">B</span><span class="o">&gt;</span> <span class="n">dictionary</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashBiMap</span><span class="o">&lt;</span><span class="n">A</span><span class="o">,</span> <span class="n">B</span><span class="o">&gt;(</span> <span class="o">);</span>
</span><span class='line'><span class="c1">// now the initialization loop</span>
</span><span class='line'> <span class="k">while</span> <span class="o">(</span> <span class="n">it</span><span class="o">.</span><span class="na">hasMore</span><span class="o">(</span> <span class="o">))</span> <span class="o">{</span>
</span><span class='line'>  <span class="n">B</span> <span class="n">val</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="na">next</span><span class="o">(</span> <span class="o">);</span>
</span><span class='line'>  <span class="n">A</span> <span class="n">key</span> <span class="o">=</span> <span class="n">computeKey</span><span class="o">(</span> <span class="n">val</span><span class="o">);</span>
</span><span class='line'>  <span class="n">dictionary</span><span class="o">.</span><span class="na">put</span><span class="o">(</span> <span class="n">key</span><span class="o">,</span> <span class="n">val</span><span class="o">);</span>
</span><span class='line'> <span class="o">}</span>
</span><span class='line'>
</span><span class='line'> <span class="c1">// now in order to get key for a value we have to do:</span>
</span><span class='line'> <span class="n">A</span> <span class="n">key</span> <span class="o">=</span> <span class="n">dictionary</span><span class="o">.</span><span class="na">inverse</span><span class="o">(</span> <span class="o">).</span><span class="na">get</span><span class="o">(</span> <span class="n">val</span><span class="o">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>There is much more things and useful functionality provided by Guava, I&rsquo;ll continue to describe uses cases and method which will allow to remove boiler plate and redundant code.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">C0rWin</span></span>

      








  


<time datetime="2013-10-16T15:11:00+03:00" pubdate data-updated="true">Oct 16<span>th</span>, 2013</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/collections/'>collections</a>, <a class='category' href='/blog/categories/guava/'>guava</a>, <a class='category' href='/blog/categories/java/'>java</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://pensieve.info/blog/2013/10/16/java-collections/" data-via="C0rWin" data-counturl="http://pensieve.info/blog/2013/10/16/java-collections/" >Tweet</a>
  
  
  
</div>

    
    
    <section>
      <h1>Comments</h1>
      <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
    </section>
    
    <ul class="pager">
      
      <li class="previous"><a class="basic-alignment left"
        href="/blog/2013/10/08/running-matlab-code-on-amazon-cloud/" title="Previous Post:
        Running Matlab code on Amazon cloud.">&laquo; Running Matlab code on Amazon cloud.</a></li>
      
      <li><a href="/blog/archives">Blog Archives</a></li>
      
      <li class="next"><a class="basic-alignment right" href="/blog/2013/12/03/computing-hits-algorithm-with-map-reduce-and-mongodb/"
        title="Next Post: Computing HITS algorithm with Map-Reduce and MongoDB.">Computing HITS algorithm with Map-Reduce and MongoDB.
        &raquo;</a></li>
      
    </ul>
  </footer>
</article>

<aside class="sidebar-nav span3">
  
    <section class="well">
  <ul id="recent_posts" class="nav nav-list">
    <li class="nav-header">Recent Posts</li>
    
      <li class="post">
        <a href="/blog/2013/12/03/computing-hits-algorithm-with-map-reduce-and-mongodb/">Computing HITS algorithm with Map-Reduce and MongoDB.</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/10/16/java-collections/">Java Collections, Guava, reducing boilerplate code</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/10/08/running-matlab-code-on-amazon-cloud/">Running Matlab code on Amazon cloud.</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/10/07/putting-all-together-setup-hadoop-cluster-on-vm-with-puppet/">Putting All Together Setup Hadoop Cluster On Vm With Puppet</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/09/30/israel-global-day-of-code-retreat/">Israel Global Day of Code Retreat 2013.</a>
      </li>
    
  </ul>
</section>

<section class="well">
  <ul id="gh_repos" class="nav">
    <li class="nav-header">GitHub Repos</li>
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/C0rWin">@C0rWin</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        github.showRepos({
            user: 'C0rWin',
            count: 3,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/asides/github.js" type="text/javascript"> </script>
</section>

<section class="well">
	<ul id="top-categoty-list" class="nav nav-list">
				<li class="nav-header">Top Categories</li>
				<ul><li><a href='/blog/categories/java'>java (2)</a></li><li><a href='/blog/categories/vagrant'>vagrant (2)</a></li><li><a href='/blog/categories/vm'>vm (2)</a></li><li><a href='/blog/categories/puppet'>puppet (2)</a></li><li><a href='/blog/categories/scripts'>scripts (2)</a></li><li><a href='/blog/categories/virtualization'>virtualization (2)</a></li><li><a href='/blog/categories/automation'>automation (2)</a></li><li><a href='/blog/categories/distributed'>distributed (2)</a></li><li><a href='/blog/categories/gdcr-2013'>GDCR_2013 (1)</a></li><li><a href='/blog/categories/amazon'>amazon (1)</a></li></ul>
	</ul>
</section>


<section class="well">
  <ul class="nav nav-list">
			<h2>
				<a href="https://plus.google.com/103540838953598223632?rel=author">
						<img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
						Google+
				</a>
		  </h2>
  </ul>
</section>



  
</aside>


    </div>
  </div>
  <footer role="contentinfo" class="page-footer"><hr>
<p>
  Copyright &copy; 2013 - C0rWin -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'c0rwinnotes';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://pensieve.info/blog/2013/10/16/java-collections/';
        var disqus_url = 'http://pensieve.info/blog/2013/10/16/java-collections/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
